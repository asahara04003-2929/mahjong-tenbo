/* スマホ画面縦横 */
/* 共通（縦も横も） */
:root{
  --safe-top: env(safe-area-inset-top, 0px);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}

/* 縦 */
@media (orientation: portrait) {
  body { padding-top: var(--safe-top); padding-bottom: var(--safe-bottom); }
  /* 例：縦は卓を大きめに */
  .gs-layout { gap: 12px; }
  .gs-north{ top: 40px; }
  .gs-west{ top: 170px; }
  .gs-south{ top: 170px; }
  .gs-self{ top: 300px; }
  .gs-panel { margin-top: 100px; }
}


/* 横 */
@media (orientation: landscape) {
  body { padding-top: var(--safe-top); padding-bottom: var(--safe-bottom); }
  /* 例：横はパネルを少し細くする */
  .gs-panel { width: 320px; }
  .gs-layout { gap: 8px; }
  .gs-north{ top: 10px; }
  .gs-west{ top: 70px; }
  .gs-south{ top: 70px; }
  .gs-self{ top: 140px; }
}

.is-landscape .gs-panel { width: 320px; }
.is-portrait  .gs-panel { width: auto; }

body{
  padding-left: env(safe-area-inset-left, 0px);
  padding-right: env(safe-area-inset-right, 0px);
  padding-top: env(safe-area-inset-top, 0px);
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

/* 横向き時：卓の高さを iPhone縦幅(393px) に合わせる */
@media (orientation: landscape) {
  .gs-tableWrap{
    min-height: calc(393px - env(safe-area-inset-left) - env(safe-area-inset-right));
  }

  .gs-table{
    height: calc(393px - env(safe-area-inset-left) - env(safe-area-inset-right));
  }
}

.hidden {
  display: none;
}

#table {
  max-width: 600px;
  margin: 0 auto;
  text-align: center;
}

.row {
  display: flex;
  justify-content: space-between;
  margin-top: 20px;
}

.playerBox {
  border: 1px solid #999;
  padding: 10px;
  width: 150px;
  min-height: 60px;
  background: #f9f9f9;
}

.playerBox.self {
  border: 2px solid #4caf50;
  font-weight: bold;
}


.gameTable{
  display:grid;
  grid-template-columns: 1fr 1fr 1fr;
  grid-template-areas:
    ". north ."
    "west self south";
  gap:10px;
  justify-items:center;
  align-items:center;
}
.pos{ background:#fff; border:1px solid #888; padding:8px 10px; border-radius:6px; min-width:140px; text-align:center; }
.north{ grid-area:north; }
.west{ grid-area:west; }
.self{ grid-area:self; min-width:140px; padding:16px; }
.south{ grid-area:south; }

.name,.selfName{ font-weight:bold; margin-bottom:4px; }
.point{ font-size:14px; }
.selfPoint{ font-size:28px; font-weight:800; }
.diff{ margin-top:4px; font-size:12px; }
.diff.negative{ color:#c00; font-weight:700; } /* マイナスは赤 */

.sendBtn{ margin-top:6px; }
.amtBtn{ min-width:80px; }


/* ===== ルーム一覧画面 ===== */
.roomListHeader, .roomListRow{
  display: grid;
  grid-template-columns: 140px 90px 90px 170px 80px 1fr;
  gap: 10px;
  align-items: center;
}

.roomListHeader{
  font-weight: bold;
  padding: 6px 0;
  border-bottom: 2px solid #ccc;
}

.roomListRow{
  padding: 6px 0;
  border-bottom: 1px solid #e0e0e0;
}

.roomCell{ font-size: 14px; }

.seatGrid{
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  grid-template-rows: 1fr 1fr 1fr;
  gap: 2px;
  width: 160px;
  height: 80px;
}

.seat{
  display:flex;
  align-items:center;
  justify-content:center;
  font-size: 12px;
  border: 1px solid #ddd;
  border-radius: 6px;
  background: #fff;
  padding: 2px 4px;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.seat.empty{
  border: none;
  background: transparent;
}

.ops{
  display:flex;
  gap: 6px;
  flex-wrap: wrap;
}



/* ===== 対局画面（横向きスマホ想定） ===== */

#gameScreen{
  background:#bfe6b0;
  border:2px solid #222;
  padding:10px;
  box-sizing:border-box;
  max-width: 1100px;
  margin: 10px auto;
}

.gs-title{
  margin:0;
  font-size:18px;
}

.gs-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  margin-bottom:8px;
  position: relative;
}

.gs-headerRight{
  display:flex;
  align-items:center;
  gap:8px;
  flex-wrap:wrap;
}

.gs-label{
  font-size:12px;
  opacity:.85;
}

.gs-riichiBox{
  position:absolute;
  left:10px;
  top:-6px;
  background: transparent !important;
  border:none !important;
  font-weight:900;
}

.gs-riichiCount{
  font-weight:800;
  font-size:16px;
}

#btnRiichiAdd{
  min-width:120px;
}

/* 横向き：左 卓 / 右 操作 */
.gs-landscape{
  display:grid;
  grid-template-columns: 1.2fr 0.8fr;
  gap:10px;
  align-items:start;
}

/* ===== 卓 ===== */
.gs-tableWrap{
  min-height: 380px;
}

.gs-table{
  position:relative;
  height: 380px;
}

/* 座席 */
.gs-seat{
  position:absolute;
  background:#fff;
  border:2px solid #222;
  padding:8px 10px;
  box-sizing:border-box;
  text-align:center;
  min-width: 135px;
}

.gs-name{ font-weight:800; margin-bottom:4px; font-size:14px; }
.gs-point{ font-size:18px; line-height:1.1; }
.gs-diff{ font-size:12px; margin-top:4px; }

/* JSが付ける negative に対応 */
.negative{ color:#c00; }

.gs-sendBtn{
  margin-top:6px;
  padding:10px 12px;
  border:2px solid #222;
  background:#fff;
  font-weight:800;
  cursor:pointer;
  min-height:44px; /* スマホ基準 */
}

/* 配置（画像に寄せる） */
.gs-north{
  left: 50%;
  transform: translateX(-50%);
}
.gs-west{
  left: 30px !important;
}
.gs-south{
  right: 30px !important;
}
.gs-self{
  left: 50%;
  transform: translateX(-50%);
  width: 150px !important;
  padding: 14px 10px;
}
.gs-selfName{ font-weight:900; margin-bottom:8px; }
.gs-selfPoint{ font-size:42px; font-weight:900; letter-spacing:1px; }

/* ===== 右：操作 ===== */
.gs-panel{
  display:flex;
  flex-direction:column;
  gap:10px;
}

.gs-card{
  background:#fff;
  border:2px solid #222;
  padding:10px;
  box-sizing:border-box;
}

.gs-statusRow{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  padding:4px 0;
}

.gs-statusLabel{
  font-size:12px;
  opacity:.85;
  width:70px;
}

.gs-statusValue{
  font-size:36px;
  font-weight:900;
}

/* 金額ボタン：大きめタイル */
.gs-amountGrid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:10px;
}

.gs-amtBtn{
  border:2px solid #222;
  background:#fff;
  font-weight:900;
  padding:14px 10px;
  cursor:pointer;
  min-height:56px;      /* 押しやすい */
  font-size:16px;
}

.gs-amtSub{
  opacity:.9;
}

/* 共通ボタン */
.gs-btn{
  border:2px solid #222;
  background:#fff;
  font-weight:900;
  padding:12px 12px;
  cursor:pointer;
  min-height:44px;
}

/* 確定を最重要に（サイズで目立たせる） */
.gs-actionRow{
  display:grid;
  grid-template-columns: 1.2fr 0.8fr;
  gap:10px;
}

.gs-btnConfirm{
  padding:16px 12px;
  min-height:58px;
  font-size:18px;
}

.gs-btnCancel{
  padding:16px 12px;
  min-height:58px;
}

.gs-footerRow{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}

.gs-btnEnd{
  min-height:52px;
}

/* ===== 小さい横幅（古いスマホ等）対策 ===== */
@media (max-width: 760px){
  .gs-landscape{
    grid-template-columns: 1fr; /* どうしても狭いなら縦に落とす */
  }
  .gs-table{
    height: 420px;
  }
}

.gs-sendBtn.holding{
  animation:pulse 1s linear infinite;
}

@keyframes pulse{
  0%{background:#fff;}
  50%{background:#ffe08a;}
  100%{background:#fff;}
}



/* ===== Bottom Sheet (Drawer) ===== */
.ts-overlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.35);
  z-index: 999;
}

.ts-sheet{
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 1000;

  background: #fff;
  border-radius: 16px 16px 0 0;
  padding: 12px 12px calc(12px + env(safe-area-inset-bottom));
  box-shadow: 0 -10px 30px rgba(0,0,0,0.25);

  transform: translateY(105%);
  transition: transform 220ms ease;
}

/* 表示状態 */
.ts-sheet.is-open{
  transform: translateY(0);
}

.ts-handle{
  width: 48px;
  height: 5px;
  border-radius: 999px;
  background: #ccc;
  margin: 4px auto 10px;
}

.ts-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin-bottom: 10px;
}

.ts-title{ font-weight: 700; }
.ts-close{
  border: none;
  background: transparent;
  font-size: 20px;
  line-height: 1;
  padding: 6px 10px;
  cursor: pointer;
}

/* 相手パネルをタップ可能に（赤枠） */
.gs-seat.tapTarget {
  cursor: pointer;
  user-select: none;
  outline-offset: -3px;
}

:root{
  --vh: 1vh;
}

/* 対局画面を常に端末の実高さに合わせる */
#gameScreen{
  height: calc(var(--vh) * 100);
  max-height: calc(var(--vh) * 100);
  overflow: auto;
}


/* ===== リーチ棒HUD（左上・赤枠位置）===== */
.riichiHUD{
  position:absolute;
  top: 44px;      /* ここを調整（赤枠に合わせる） */
  left: 14px;     /* ここを調整（赤枠に合わせる） */
  display:flex;
  align-items:center;
  gap: 10px;
  z-index: 5;
}

/* リーチ棒（CSSで描画） */
.riichiStick{
  position: relative;
  width: 96px;
  height: 16px;
  border-radius: 999px;
  border: 1px solid rgba(0,0,0,.55);
  /* 白い樹脂っぽい立体感（ハイライト/影） */
  background:
    linear-gradient(180deg,
      #ffffff 0%,
      #f5f5f5 35%,
      #e9e9e9 70%,
      #ffffff 100%);
  box-shadow:
    0 2px 0 rgba(0,0,0,.18),
    inset 0 1px 0 rgba(255,255,255,.9),
    inset 0 -1px 0 rgba(0,0,0,.12);
}

/* 赤い印（一般的な1000点棒の「赤点」っぽさ） */
.riichiStick::before{
  content:"";
  position:absolute;
  left: 50%;
  top: 50%;
  width: 8px;
  height: 8px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, #ffb3b3 0%, #e40000 55%, #a80000 100%);
  box-shadow: 0 0 0 1px rgba(0,0,0,.25);
}

/* 端の小さな面取り（より棒っぽく） */
.riichiStick::after{
  content:"";
  position:absolute;
  inset: 2px;
  border-radius: 999px;
  background: linear-gradient(90deg,
    rgba(0,0,0,.12) 0%,
    rgba(0,0,0,0) 14%,
    rgba(0,0,0,0) 86%,
    rgba(0,0,0,.12) 100%);
  pointer-events:none;
  opacity:.55;
}

/* ×数値 */
.riichiTimes{
  font-weight: 900;
  font-size: 18px;
  letter-spacing: .5px;
  text-shadow: 0 1px 0 rgba(255,255,255,.4);
}


/* ===== 共通カード行（ポップアップで使用） ===== */
.gs-cardRow{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  padding:6px 0;
}
.gs-cardLabel{ font-size:12px; opacity:.85; width:70px; }
.gs-cardValue{ font-size:16px; font-weight:900; }

/* ===== 履歴 ===== */
.historyList{
  max-height: 60vh;
  overflow-y: auto;
  display:flex;
  flex-direction:column;
  gap:10px;
  padding-bottom: 8px;
}
.historyItem{
  background:#fff;
  border:2px solid #222;
  border-radius:10px;
  padding:10px;
}
.historyTop{
  display:flex;
  justify-content:space-between;
  gap:10px;
  font-size:12px;
  opacity:.85;
}
.historyMain{
  margin-top:6px;
  display:flex;
  justify-content:space-between;
  align-items:baseline;
  gap:10px;
}
.historyWho{
  font-weight:900;
  font-size:14px;
}
.historyPoint{
  font-weight:900;
  font-size:18px;
}
.historyMeta{
  margin-top:6px;
  font-size:12px;
  opacity:.9;
  display:flex;
  justify-content:space-between;
  gap:10px;
}
.historyBadge{
  font-weight:900;
  padding:2px 8px;
  border:2px solid #222;
  border-radius:999px;
  font-size:12px;
}

/* ===== ヤキトリ画像（点数枠右下） ===== */
.gs-seat{ position:absolute; } /* 既存ありだが念押し */
.yakitoriImg{
  position:absolute;
  top: 5px;
  right: 5px;
  width:42px;
  height:auto;
  pointer-events:none;
}

/* ヤキトリ画像を消す */
.yakitoriImg.is-hidden {
  display: none !important;
}

/* 集計画面：ヤキトリボタン（画像） */
.yakitoriBtn{
  border: none;
  background: transparent;
  padding: 0;
  cursor: pointer;
  perspective: 700px;           /* 3D感 */
}

.yakitoriBtn:disabled{
  opacity: .35;
  cursor: default;
}

/* 画像（カード面） */
.yakitoriBtnImg{
  display: block;
  width: 96px;                  /* 好みで調整 */
  height: auto;
  transform-style: preserve-3d;
  backface-visibility: hidden;
  transition: transform 260ms ease;
}

/* ひっくり返す */
.yakitoriBtn.is-flipping .yakitoriBtnImg{
  transform: rotateY(180deg);
}
